var $e=Object.create;var oe=Object.defineProperty;var Me=Object.getOwnPropertyDescriptor;var Re=Object.getOwnPropertyNames;var Ue=Object.getPrototypeOf,ze=Object.prototype.hasOwnProperty;var Fe=(n,o)=>()=>(o||n((o={exports:{}}).exports,o),o.exports);var Te=(n,o,u,m)=>{if(o&&typeof o=="object"||typeof o=="function")for(let f of Re(o))!ze.call(n,f)&&f!==u&&oe(n,f,{get:()=>o[f],enumerable:!(m=Me(o,f))||m.enumerable});return n};var De=(n,o,u)=>(u=n!=null?$e(Ue(n)):{},Te(o||!n||!n.__esModule?oe(u,"default",{value:n,enumerable:!0}):u,n));var ie=Fe((N,q)=>{(function(n,o){typeof N=="object"&&typeof q<"u"?q.exports=o():typeof define=="function"&&define.amd?define(o):(n=typeof globalThis<"u"?globalThis:n||self).ImageKit=o()})(N,(function(){"use strict";function n(t){return(n=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function o(t,e){for(var r=0;r<e.length;r++){var a=e[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}function u(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function m(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable}))),r.push.apply(r,a)}return r}function f(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?m(Object(r),!0).forEach((function(a){u(t,a,r[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):m(Object(r)).forEach((function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(r,a))}))}return t}function E(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,a=new Array(e);r<e;r++)a[r]=t[r];return a}function P(t,e){var r;if(typeof Symbol>"u"||t[Symbol.iterator]==null){if(Array.isArray(t)||(r=(function(l,v){if(l){if(typeof l=="string")return E(l,v);var h=Object.prototype.toString.call(l).slice(8,-1);return h==="Object"&&l.constructor&&(h=l.constructor.name),h==="Map"||h==="Set"?Array.from(l):h==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(h)?E(l,v):void 0}})(t))||e&&t&&typeof t.length=="number"){r&&(t=r);var a=0,c=function(){};return{s:c,n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(l){throw l},f:c}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var p,s=!0,i=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var l=r.next();return s=l.done,l},e:function(l){i=!0,p=l},f:function(){try{s||r.return==null||r.return()}finally{if(i)throw p}}}}var S={message:"Missing urlEndpoint during SDK initialization",help:""},M={message:"Invalid transformationPosition parameter",help:""},pe={message:"Missing file parameter for upload",help:""},de={message:"Missing fileName parameter for upload",help:""},fe={message:"Missing public key for upload",help:""},me={message:"Request to ImageKit upload endpoint failed due to network error",help:""},ge={message:"Invalid uploadOptions parameter",help:""},he={message:"Missing signature for upload. The SDK expects token, signature and expire for authentication.",help:""},ye={message:"Missing token for upload. The SDK expects token, signature and expire for authentication.",help:""},ve={message:"Missing expire for upload. The SDK expects token, signature and expire for authentication.",help:""},be={message:"Invalid transformation parameter. Please include at least pre, post, or both.",help:""},we={message:"Invalid pre transformation parameter.",help:""},z={message:"Invalid post transformation parameter.",help:""};function g(t,e,r){typeof r=="function"&&(t?r(e,null):r(null,e))}function Ee(t){var e={},r=t.getAllResponseHeaders();return Object.keys(r).length&&r.trim().split(/[\r\n]+/).map((function(a){return a.split(/: /)})).forEach((function(a){e[a[0].trim()]=a[1].trim()})),e}var _=function(t,e){var r=f({},t),a={statusCode:e.status,headers:Ee(e)};return Object.defineProperty(r,"$ResponseMetadata",{value:a,enumerable:!1,writable:!1}),r},Ie=function(t,e){return new Promise((function(r,a){t.open("POST","https://upload.imagekit.io/api/v1/files/upload"),t.onerror=function(c){return a(me)},t.onload=function(){if(t.status===200)try{var c=JSON.parse(t.responseText),p=_(c,t);return r(p)}catch(i){return a(i)}else try{c=JSON.parse(t.responseText);var s=_(c,t);return a(s)}catch(i){return a(i)}},t.send(e)}))},ke=function(t,e,r,a){if(e.file)if(e.fileName)if(r.publicKey)if(e.token)if(e.signature)if(e.expire){if(e.transformation){if(!Object.keys(e.transformation).includes("pre")&&!Object.keys(e.transformation).includes("post"))return void g(!0,be,a);if(Object.keys(e.transformation).includes("pre")&&!e.transformation.pre)return void g(!0,we,a);if(Object.keys(e.transformation).includes("post")){if(!Array.isArray(e.transformation.post))return void g(!0,z,a);var c,p=P(e.transformation.post);try{for(p.s();!(c=p.n()).done;){var s=c.value;if(s.type==="abs"&&!s.protocol&&!s.value||s.type==="transformation"&&!s.value)return void g(!0,z,a)}}catch(v){p.e(v)}finally{p.f()}}}var i,l=new FormData;for(i in e)i&&(i==="file"&&typeof e.file!="string"?l.append("file",e.file,String(e.fileName)):i==="tags"&&Array.isArray(e.tags)?l.append("tags",e.tags.join(",")):i==="signature"?l.append("signature",e.signature):i==="expire"?l.append("expire",String(e.expire)):i==="token"?l.append("token",e.token):i==="responseFields"&&Array.isArray(e.responseFields)?l.append("responseFields",e.responseFields.join(",")):i==="extensions"&&Array.isArray(e.extensions)?l.append("extensions",JSON.stringify(e.extensions)):i!=="customMetadata"||n(e.customMetadata)!=="object"||Array.isArray(e.customMetadata)||e.customMetadata===null?i==="transformation"&&n(e.transformation)==="object"&&e.transformation!==null?l.append(i,JSON.stringify(e.transformation)):i==="checks"&&e.checks?l.append("checks",e.checks):e[i]!==void 0&&l.append(i,String(e[i])):l.append("customMetadata",JSON.stringify(e.customMetadata)));l.append("publicKey",r.publicKey),(function(v,h,y){Ie(v,h).then((function(x){return g(!1,x,y)}),(function(x){return g(!0,x,y)}))})(t,l,a)}else g(!0,ve,a);else g(!0,he,a);else g(!0,ye,a);else g(!0,fe,a);else g(!0,de,a);else g(!0,pe,a)},G={width:"w",height:"h",aspectRatio:"ar",background:"bg",border:"b",crop:"c",cropMode:"cm",dpr:"dpr",focus:"fo",quality:"q",x:"x",xCenter:"xc",y:"y",yCenter:"yc",format:"f",videoCodec:"vc",audioCodec:"ac",radius:"r",rotation:"rt",blur:"bl",named:"n",defaultImage:"di",flip:"fl",original:"orig",startOffset:"so",endOffset:"eo",duration:"du",streamingResolutions:"sr",grayscale:"e-grayscale",aiUpscale:"e-upscale",aiRetouch:"e-retouch",aiVariation:"e-genvar",aiDropShadow:"e-dropshadow",aiChangeBackground:"e-changebg",aiRemoveBackground:"e-bgremove",aiRemoveBackgroundExternal:"e-removedotbg",contrastStretch:"e-contrast",shadow:"e-shadow",sharpen:"e-sharpen",unsharpMask:"e-usm",gradient:"e-gradient",progressive:"pr",lossless:"lo",colorProfile:"cp",metadata:"md",opacity:"o",trim:"t",zoom:"z",page:"pg",fontSize:"fs",fontFamily:"ff",fontColor:"co",innerAlignment:"ia",padding:"pa",alpha:"al",typography:"tg",lineHeight:"lh",fontOutline:"fol",fontShadow:"fsh",raw:"raw"},Se=["path","query"],xe=function(){return"query"},Z=function(t){return t.transformationPosition==="query"},Ae=function(t){return t.transformationPosition!==void 0&&Se.indexOf(t.transformationPosition)!=-1},Oe=function(t){return t&&(G[t]||G[t.toLowerCase()])||""},X=function(){return":"},Y=function(){return","},je=function(){return"-"},R=function(t){return typeof window<"u"?btoa(t):Buffer.from(t,"utf8").toString("base64")},Le=new RegExp("^[a-zA-Z0-9-._/ ]*$"),Pe=new RegExp("^[a-zA-Z0-9-._ ]*$");function Q(t){return typeof t=="string"&&t[t.length-1]=="/"&&(t=t.substring(0,t.length-1)),t}function ee(t){return typeof t=="string"&&t[0]=="/"&&(t=t.slice(1)),t}function F(t,e){var r=e||"/",a=new RegExp(r+"{1,}","g");return t.join(r).replace(a,r)}function T(t,e){return t=Q(ee(t)),e==="plain"?"i-".concat(t.replace(/\//g,"@@")):e==="base64"?"ie-".concat(encodeURIComponent(R(t))):Le.test(t)?"i-".concat(t.replace(/\//g,"@@")):"ie-".concat(encodeURIComponent(R(t)))}function Be(t){var e=[];if(t){var r=t.type,a=t.position,c=a===void 0?{}:a,p=t.timing,s=p===void 0?{}:p,i=t.transformation,l=i===void 0?[]:i;if(!r)throw new Error("Overlay type is required");switch(r){case"text":var v=t;if(!v.text)return;var h=v.encoding||"auto";e.push("l-text"),e.push((function(C,ae){return ae==="plain"?"i-".concat(encodeURIComponent(C)):ae==="base64"?"ie-".concat(encodeURIComponent(R(C))):Pe.test(C)?"i-".concat(encodeURIComponent(C)):"ie-".concat(encodeURIComponent(R(C)))})(v.text,h));break;case"image":e.push("l-image");var y=t,x=y.encoding||"auto";if(!y.input)return;e.push(T(y.input,x));break;case"video":e.push("l-video");var j=t,b=j.encoding||"auto";if(!j.input)return;e.push(T(j.input,b));break;case"subtitle":e.push("l-subtitle");var I=t,D=I.encoding||"auto";if(!I.input)return;e.push(T(I.input,D));break;case"solidColor":e.push("l-image"),e.push("i-ik_canvas");var U=t;if(!U.color)return;e.push("bg-".concat(U.color))}var B=c.x,L=c.y,A=c.focus;B&&e.push("lx-".concat(B)),L&&e.push("ly-".concat(L)),A&&e.push("lfo-".concat(A));var O=s.start,ne=s.end,re=s.duration;O&&e.push("lso-".concat(O)),ne&&e.push("leo-".concat(ne)),re&&e.push("ldu-".concat(re));var K=te(l);return K&&K.trim()!==""&&e.push(K),e.push("l-end"),e.join(Y())}}function te(t){if(!Array.isArray(t))return"";for(var e=[],r=0,a=t.length;r<a;r++){var c=[];for(var p in t[r]){var s=t[r][p];if(s!=null)if(p!=="overlay"||n(s)!=="object"){var i=Oe(p);if(i||(i=p),i!=="")if(["e-grayscale","e-contrast","e-removedotbg","e-bgremove","e-upscale","e-retouch","e-genvar"].includes(i)){if(s!==!0&&s!=="-"&&s!=="true")continue;c.push(i)}else!["e-sharpen","e-shadow","e-gradient","e-usm","e-dropshadow"].includes(i)||s.toString().trim()!==""&&s!==!0&&s!=="true"?p==="raw"?c.push(t[r][p]):(i==="di"&&(s=(s=Q(ee(s||""))).replace(/\//g,"@@")),i==="sr"&&Array.isArray(s)&&(s=s.join("_")),i==="t"&&s.toString().trim()===""&&(s="true"),c.push([i,s].join(je()))):c.push(i)}else{var l=Be(s);l&&l.trim()!==""&&c.push(l)}}c.length&&e.push(c.join(Y()))}return e.join(X())}var Ce=function(t,e){return(function(r){if(!r.path&&!r.src)return"";var a,c,p;try{r.path?(p=new URL(r.urlEndpoint).pathname,a=new URL(F([r.urlEndpoint.replace(p,""),r.path]))):(a=new URL(r.src),c=!0)}catch(l){return console.error(l),""}for(var s in r.queryParameters)a.searchParams.append(s,String(r.queryParameters[s]));var i=te(r.transformation);return i&&i.length&&(Z(r)||c||(a.pathname=F(["tr"+X()+i,a.pathname]))),a.pathname=F(p?[p,a.pathname]:[a.pathname]),i&&i.length&&(Z(r)||c)?a.searchParams.toString()!==""?"".concat(a.href,"&").concat("tr","=").concat(i):"".concat(a.href,"?").concat("tr","=").concat(i):a.href})(f(f({},e),t))};return(function(){function t(c){if((function(p,s){if(!(p instanceof s))throw new TypeError("Cannot call a class as a function")})(this,t),u(this,"options",{publicKey:"",urlEndpoint:"",transformationPosition:xe()}),this.options=f(f({},this.options),c||{}),!this.options.urlEndpoint)throw S;if(!Ae(this.options))throw M}var e,r,a;return e=t,(r=[{key:"url",value:function(c){return Ce(c,this.options)}},{key:"upload",value:function(c,p,s){var i;if(typeof p=="function"?i=p:s=p||{},!c||n(c)!=="object")return g(!0,ge,i);var l=f(f({},this.options),s),v=(c||{}).xhr;delete c.xhr;var h,y,x=v||new XMLHttpRequest;return(h=this,y=ke,function(){for(var j=arguments.length,b=new Array(j),I=0;I<j;I++)b[I]=arguments[I];if(b.length!==y.length||b[b.length-1]===void 0)return new Promise((function(D,U){b.pop(),b.push((function(B){if(B)return U(B);for(var L=arguments.length,A=new Array(L>1?L-1:0),O=1;O<L;O++)A[O-1]=arguments[O];D(A.length>1?A:A[0])})),y.call.apply(y,[h].concat(b))}));if(typeof b[b.length-1]!="function")throw new Error("Callback must be a function.");y.call.apply(y,[h].concat(b))})(x,c,l,i)}}])&&o(e.prototype,r),a&&o(e,a),t})()}))});var se=De(ie());import{initializeApp as Ke}from"https://www.gstatic.com/firebasejs/12.0.0/firebase-app.js";import{getDatabase as Ne,ref as W,push as qe,onValue as We,update as Ve,remove as Je}from"https://www.gstatic.com/firebasejs/12.0.0/firebase-database.js";import{getAuth as He,onAuthStateChanged as _e,GoogleAuthProvider as Ge,signInWithPopup as Ze,signInWithEmailAndPassword as Xe,signOut as Ye}from"https://www.gstatic.com/firebasejs/12.0.0/firebase-auth.js";var Qe={apiKey:"AIzaSyD0xLuJlNiWr9-VvPOSxeYKXdfxzf1OZHM",authDomain:"do-to-list-aa1eb.firebaseapp.com",projectId:"do-to-list-aa1eb",storageBucket:"do-to-list-aa1eb.firebasestorage.app",messagingSenderId:"518478895264",appId:"1:518478895264:web:cbcba241dcd91c3ff651c5",databaseURL:"https://do-to-list-aa1eb-default-rtdb.firebaseio.com"},V={publicKey:"public_aF1VLWznWZonCwPUp2VzFSZFFjw=",urlEndpoint:"https://ik.imagekit.io/rkndkbsiy",authenticationEndpoint:"https://fleursdz.netlify.app/.netlify/functions/imagekit-auth"},le=Ke(Qe),J=Ne(le),ce=W(J,"media"),k=He(le),et=new Ge,ue;try{ue=new se.default(V),console.log("ImageKit initialized successfully")}catch(n){throw console.error("Failed to initialize ImageKit:",n),alert("\u0641\u0634\u0644 \u062A\u062D\u0645\u064A\u0644 \u0645\u0643\u062A\u0628\u0629 ImageKit. \u0627\u0644\u0631\u062C\u0627\u0621 \u0627\u0644\u062A\u062D\u0642\u0642 \u0645\u0646 \u0627\u0644\u0625\u0639\u062F\u0627\u062F\u0627\u062A."),n}var d={authSection:document.getElementById("authSection"),adminSection:document.getElementById("adminSection"),emailForm:document.getElementById("emailForm"),emailInput:document.getElementById("email"),passInput:document.getElementById("password"),googleBtn:document.getElementById("googleLoginBtn"),authMsg:document.getElementById("authMsg"),logoutBtn:document.getElementById("logoutBtn"),currentUserEl:document.getElementById("currentUser"),fileInput:document.getElementById("fileInput"),uploadBtn:document.getElementById("uploadBtn"),uploadList:document.getElementById("uploadList"),gallery:document.getElementById("gallery"),defaultAlt:document.getElementById("defaultAlt"),refreshBtn:document.getElementById("refreshBtn"),dropzone:document.getElementById("dropzone")},w={show:n=>n.style.display="",hide:n=>n.style.display="none",setAuthError:n=>{d.authMsg.textContent=n,d.authMsg.style.display=n?"block":"none"},isVideo:n=>n.type.startsWith("video/"),isImage:n=>n.type.startsWith("image/"),getFileName:n=>n.name.replace(/\.[^.]+$/,""),createProgressRow:n=>{let o=document.createElement("div");return o.className="border rounded p-2",o.innerHTML=`
            <div class="small mb-1">${n.name}</div>
            <div class="progress">
                <div class="progress-bar" style="width:0%"></div>
            </div>
            <div class="error text-danger mt-1" style="display:none;"></div>
        `,o}},H={loginWithGoogle:()=>{let n=location.hostname==="localhost"||location.hostname==="127.0.0.1";(n?signInWithRedirect:Ze)(k,et).then(u=>console.log("User signed in:",u.user)).catch(u=>{console.error(`${n?"Redirect":"Popup"} Error:`,u),w.setAuthError("\u0641\u0634\u0644 \u062A\u0633\u062C\u064A\u0644 \u0627\u0644\u062F\u062E\u0648\u0644 \u0628\u0627\u0633\u062A\u062E\u062F\u0627\u0645 \u062C\u0648\u062C\u0644.")})},handleAuthState:n=>{n?(w.hide(d.authSection),w.show(d.adminSection),d.currentUserEl.textContent=n.email||""):(w.show(d.authSection),w.hide(d.adminSection),d.currentUserEl.textContent="")},handleEmailLogin:async n=>{n.preventDefault();try{await Xe(k,d.emailInput.value,d.passInput.value)}catch(o){console.error("Email login error:",o),w.setAuthError("\u0641\u0634\u0644 \u062A\u0633\u062C\u064A\u0644 \u0627\u0644\u062F\u062E\u0648\u0644. \u062A\u0623\u0643\u062F \u0645\u0646 \u0627\u0644\u0628\u0631\u064A\u062F \u0648\u0643\u0644\u0645\u0629 \u0627\u0644\u0645\u0631\u0648\u0631.")}}},$={renderCard:(n,o)=>{let u=o.type==="video",m=u?`${o.url}#t=0.5`:`${o.url}?tr=w-400,h-400,fo-auto`,f=document.createElement("div");return f.className="card position-relative",f.innerHTML=`
            <span class="badge text-bg-${u?"dark":"info"} badge-type">${u?"\u0641\u064A\u062F\u064A\u0648":"\u0635\u0648\u0631\u0629"}</span>
            ${u?`<video class="w-100" src="${o.url}" preload="metadata" controls></video>`:`<img class="w-100 thumb" loading="lazy" src="${m}" alt="${o.alt||""}">`}
            <div class="p-2 d-flex gap-2 align-items-center">
                <input class="form-control form-control-sm" value="${o.alt||""}" placeholder="alt" data-key="${n}"/>
                <button class="btn btn-sm btn-outline-primary save" data-key="${n}">\u062D\u0641\u0638</button>
                <button class="btn btn-sm btn-outline-danger del" data-key="${n}" data-fileid="${o.fileId||""}">\u062D\u0630\u0641</button>
            </div>
        `,f},paintGallery:n=>{if(d.gallery.innerHTML="",!n)return;Object.entries(n).sort(([,u],[,m])=>(u.order||0)-(m.order||0)).forEach(([u,m])=>{d.gallery.appendChild($.renderCard(u,m))})},uploadFile:async n=>{let o=w.createProgressRow(n),u=o.querySelector(".progress-bar"),m=o.querySelector(".error");d.uploadList.prepend(o);try{console.log("Fetching auth parameters from:",V.authenticationEndpoint);let f=await fetch(V.authenticationEndpoint,{method:"GET",headers:{"Content-Type":"application/json"}});if(!f.ok)throw new Error(`Authentication endpoint failed: ${f.status} ${f.statusText}`);let E=await f.json();if(console.log("Auth params received:",E),!E.token||!E.signature||!E.expire)throw new Error("Invalid authentication parameters: missing token, signature, or expire");console.log("Attempting upload to ImageKit with file:",n.name);let P=await ue.upload({file:n,fileName:n.name,useUniqueFileName:!0,tags:["fleursdz"],folder:"/fleursdz",token:E.token,expire:E.expire,signature:E.signature,progress:S=>{if(S&&S.loaded&&S.total){let M=Math.round(S.loaded/S.total*100);u.style.width=`${M}%`,console.log(`Upload progress for ${n.name}: ${M}%`)}}});console.log("Upload successful, result:",P),await qe(ce,{url:P.url,fileId:P.fileId,type:w.isVideo(n)?"video":"image",alt:d.defaultAlt.value||w.getFileName(n),order:Date.now(),uid:k.currentUser.uid}),u.style.width="100%",m.style.display="none"}catch(f){throw console.error("Upload error for file",n.name,":",f),o.classList.add("border-danger"),m.textContent=`\u0641\u0634\u0644 \u0627\u0644\u0631\u0641\u0639: ${f.message}`,m.style.display="block",f}},handleSaveAlt:async n=>{if(!n.target.classList.contains("save")||!k.currentUser)return;let o=n.target.dataset.key,u=n.target.parentElement.querySelector("input");try{await Ve(W(J,`media/${o}`),{alt:u.value}),n.target.classList.replace("btn-outline-primary","btn-success"),n.target.textContent="\u062A\u0645",setTimeout(()=>{n.target.classList.replace("btn-success","btn-outline-primary"),n.target.textContent="\u062D\u0641\u0638"},800)}catch(m){console.error("Save alt error:",m),alert("\u0641\u0634\u0644 \u062D\u0641\u0638 \u0627\u0644\u062A\u0639\u062F\u064A\u0644\u0627\u062A")}},handleDelete:async n=>{if(!n.target.classList.contains("del")||!k.currentUser)return;let o=n.target.dataset.key,u=n.target.dataset.fileid;if(confirm("\u062A\u0623\u0643\u064A\u062F \u0627\u0644\u062D\u0630\u0641\u061F"))try{if(u){let m=await fetch("/.netlify/functions/imagekit-delete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fileId:u})});if(!m.ok)throw new Error(`Failed to delete file from ImageKit: ${m.statusText}`)}await Je(W(J,`media/${o}`))}catch(m){console.error("Delete error:",m),alert("\u062A\u0639\u0630\u0631 \u0627\u0644\u062D\u0630\u0641: "+m.message)}}},tt=()=>{d.googleBtn?.addEventListener("click",H.loginWithGoogle),d.emailForm?.addEventListener("submit",H.handleEmailLogin),d.logoutBtn?.addEventListener("click",()=>Ye(k)),["dragenter","dragover"].forEach(n=>d.dropzone?.addEventListener(n,o=>{o.preventDefault(),d.dropzone.style.background="#eef"})),["dragleave","drop"].forEach(n=>d.dropzone?.addEventListener(n,o=>{o.preventDefault(),d.dropzone.style.background="#fff"})),d.dropzone?.addEventListener("drop",n=>{d.fileInput.files=n.dataTransfer.files}),d.uploadBtn?.addEventListener("click",async()=>{if(!k.currentUser)return alert("\u062A\u062D\u062A\u0627\u062C \u0644\u062A\u0633\u062C\u064A\u0644 \u0627\u0644\u062F\u062E\u0648\u0644");if(!d.fileInput.files.length)return alert("\u0627\u062E\u062A\u0631 \u0645\u0644\u0641\u0627\u062A \u0623\u0648\u0644\u0627\u064B");let n=Array.from(d.fileInput.files),o=25*1024*1024;for(let u of n){if(!w.isImage(u)&&!w.isVideo(u)){alert(`\u0646\u0648\u0639 \u0627\u0644\u0645\u0644\u0641 \u063A\u064A\u0631 \u0645\u062F\u0639\u0648\u0645: ${u.name}`);return}if(u.size>o){alert(`\u0627\u0644\u0645\u0644\u0641 ${u.name} \u064A\u062A\u062C\u0627\u0648\u0632 \u0627\u0644\u062D\u062F \u0627\u0644\u0623\u0642\u0635\u0649 25 \u0645\u064A\u062C\u0627\u0628\u0627\u064A\u062A`);return}}await Promise.all(n.map(u=>$.uploadFile(u))),d.fileInput.value=""}),d.gallery?.addEventListener("click",async n=>{n.target.classList.contains("save")?await $.handleSaveAlt(n):n.target.classList.contains("del")&&await $.handleDelete(n)}),d.refreshBtn?.addEventListener("click",()=>window.location.reload())};_e(k,H.handleAuthState);We(ce,n=>$.paintGallery(n.val()));tt();
